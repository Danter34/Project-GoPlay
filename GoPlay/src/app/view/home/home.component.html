<header class="hero">
  <div class="container hero-content">
      <h1>Cháy Hết Mình Với Đam Mê</h1>
      <p>Tìm và đặt sân thể thao nhanh chóng tại khu vực của bạn</p>
  </div>
</header>

<main class="container">
  
  <div class="filter-bar">
      <div class="location-filters">
          <div class="select-wrapper">
              <select class="custom-select" [(ngModel)]="selectedCityCode" (change)="onCityChange()">
                  <option value="">Toàn quốc</option>
                  <option *ngFor="let city of cities" [value]="city.Id">{{ city.Name }}</option>
              </select>
              <i class="fas fa-map-marker-alt select-icon"></i>
          </div>

          <div class="select-wrapper">
              <select class="custom-select" [(ngModel)]="searchDistrict" (change)="onDistrictChange()" [disabled]="!selectedCityCode">
                  <option value="">Tất cả Quận/Huyện</option>
                  <option *ngFor="let dist of districts" [value]="dist.Name">{{ dist.Name }}</option>
              </select>
              <i class="fas fa-location-arrow select-icon"></i>
          </div>
      </div>

      <div class="divider"></div>

      <div class="categories-scroll">
          <div class="cat-item" [class.active]="searchSportId === 0" (click)="searchSportId = 0; onSearch()"><i class="fas fa-th-large"></i> Tất cả</div>
          <div class="cat-item" [class.active]="searchSportId === 1" (click)="searchSportId = 1; onSearch()"><i class="far fa-futbol"></i> Bóng đá</div>
          <div class="cat-item" [class.active]="searchSportId === 2" (click)="searchSportId = 2; onSearch()"><i class="fas fa-table-tennis"></i> Cầu lông</div>
          <div class="cat-item" [class.active]="searchSportId === 3" (click)="searchSportId = 3; onSearch()"><i class="fa-solid fa-baseball"></i> Tennis</div>
          <div class="cat-item" [class.active]="searchSportId === 4" (click)="searchSportId = 4; onSearch()"><i class="fa-solid fa-basketball"></i> Bóng rổ</div>
          <div class="cat-item" [class.active]="searchSportId === 5" (click)="searchSportId = 5; onSearch()"><i class="fa-solid fa-volleyball"></i> Bóng chuyền</div>
          <div class="cat-item" [class.active]="searchSportId === 6" (click)="searchSportId = 6; onSearch()"><i class="fa-solid fa-golf-ball-tee"></i> Pickleball</div>
      </div>
  </div>

  <h2 class="section-title">Danh Sách Sân Bãi</h2>
  
  <div class="fields-grid">
      <div class="field-card" *ngFor="let field of fields" [routerLink]="['/field', field.fieldId]">
          <div class="card-img-wrapper">
              <div class="status-badge" [ngClass]="field.status === 'Available' ? 'bg-success' : 'bg-danger'">
                  {{ field.status === 'Available' ? 'Còn sân' : 'Đã đầy' }}
              </div>
              <div class="rating-badge"><i class="fas fa-star"></i> {{ field.averageRating }}</div>
              <img [src]="field.images.length > 0 ? field.images[0] : 'assets/placeholder.jpg'" 
                   [alt]="field.fieldName" class="card-img">
          </div>
          <div class="card-body">
              <h3 class="card-title">{{ field.fieldName }}</h3>
              <div class="card-meta"><i class="fas fa-map-marker-alt"></i> {{ field.district }}, {{ field.city }}</div>
              <div class="card-meta"><i class="fas fa-users"></i> {{ field.sportName }}</div>
              <div class="card-footer">
                  <div class="price">{{ field.price | number }}đ <span>/giờ</span></div>
                  <button class="btn-book" (click)="$event.stopPropagation(); openBookingModal(field)">Đặt Ngay</button>
              </div>
          </div>
      </div>
  </div>

  <div class="pagination-container" *ngIf="totalPages > 1">
      <button class="btn-page" (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">
          <i class="fas fa-chevron-left"></i>
      </button>

      <button *ngFor="let page of pageNumbers" 
              class="btn-page" 
              [class.active]="page === currentPage"
              (click)="changePage(page)">
          {{ page }}
      </button>

      <button class="btn-page" (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages">
          <i class="fas fa-chevron-right"></i>
      </button>
  </div>

</main>

<div class="modal-overlay" [class.active]="isModalOpen" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
      <span class="close-modal" (click)="closeModal()">&times;</span>
      <h2 style="color: var(--secondary-color);">Xác Nhận Đặt Sân</h2>
      <p style="color: #7f8c8d; margin-bottom: 20px;">Bạn đang đặt: <strong>{{ selectedField?.fieldName }}</strong></p>
      
      <form (submit)="submitBooking()">
          <div class="form-group">
              <label class="form-label">Thông tin liên hệ</label>
              <input type="text" class="form-input" placeholder="Họ và tên" required style="margin-bottom: 10px;">
              <input type="tel" class="form-input" placeholder="Số điện thoại" required>
          </div>
          <div class="form-group">
            <label class="form-label">Thời gian</label>
            <input type="datetime-local" class="form-input" required>
        </div>
        <div style="background: #e8f8f5; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between;">
            <span style="color: var(--secondary-color); font-weight: 500;">Giá dự kiến:</span>
            <span style="color: var(--primary-color); font-size: 1.2rem; font-weight: 800;">
                {{ selectedField?.price | number }}đ
            </span>
        </div>
        <button type="submit" class="btn-submit-booking">Hoàn Tất</button>
      </form>
  </div>
</div>